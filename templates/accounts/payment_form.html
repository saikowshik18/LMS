{% extends 'base.html' %}

{% block title %}Add Payment - {{ shop.name }}{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h1 class="card-title">
            <i class="fas fa-money-bill-wave"></i>
            Pay Back Amount Owed to {{ shop.name }}
        </h1>
    </div>

    <div style="background: var(--warning-color); color: white; padding: 1rem; border-radius: 5px; margin-bottom: 1.5rem;">
        <h3 style="margin: 0 0 0.5rem 0;"><i class="fas fa-exclamation-triangle"></i> Payment to Clear Debt</h3>
        <p style="margin: 0;"><strong>Current Amount You Owe:</strong> ₹{{ shop.pending_amount|floatformat:2 }}</p>
        <p style="margin: 0.5rem 0 0 0; opacity: 0.9;">
            <i class="fas fa-info-circle"></i>
            This is NOT a deposit. This payment reduces what you owe to {{ shop.name }} for goods/services received.
        </p>
    </div>

    <div style="background: var(--light-bg); padding: 1rem; border-radius: 5px; margin-bottom: 1.5rem;">
        <p><strong>How Payments Work:</strong></p>
        <ul style="margin: 0.5rem 0 0 1.5rem; padding: 0;">
            <li>You buy goods from shops and create bills (increases what you owe)</li>
            <li>You make payments here to pay back what you owe (decreases what you owe)</li>
            <li>This keeps track of your outstanding payments to each shop</li>
        </ul>
    </div>

    <form method="post">
        {% csrf_token %}

        <div class="form-group">
            <label class="form-label" for="amount">
                <i class="fas fa-rupee-sign"></i> Amount to Pay Back (₹) *
            </label>
            <input type="number" id="amount" name="amount" class="form-control"
                   step="0.01" min="0.01" max="{{ shop.pending_amount }}" required>
            <small style="color: var(--light-text); margin-top: 0.5rem; display: block;">
                You currently owe ₹{{ shop.pending_amount|floatformat:2 }} to this shop
            </small>
        </div>

        <div class="form-group">
            <label class="form-label" for="payment_date">
                <i class="fas fa-calendar"></i> Payment Date *
            </label>
            <input type="date" id="payment_date" name="payment_date" class="form-control"
                   value="{{ initial_date|date:'Y-m-d' }}" required>
        </div>

        <div class="form-group">
            <label class="form-label" for="description">
                <i class="fas fa-comment"></i> Payment Description
            </label>
            <textarea id="description" name="description" class="form-control" rows="3"
                      placeholder="Describe what this payment is for (e.g., 'Weekly payment for lemon supplies')"></textarea>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
            <button type="submit" class="btn btn-success">
                <i class="fas fa-money-bill-wave"></i> Record Payment
            </button>
            <a href="{% url 'shop_detail' shop.id %}" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}